function y(){window.ymaps.ready(()=>{window.myMap=new window.ymaps.Map("map",{center:[59.9386,30.3141],zoom:12,controls:[],suppressMapOpenBlock:!0}),window.myPlacemark=new window.ymaps.Placemark([59.9386,30.3141],{},{iconLayout:"default#image",iconImageHref:"images/map-pin.png",iconImageSize:[26,37],iconImageOffset:[-13,-37],draggable:!0}),window.myMap.geoObjects.add(window.myPlacemark);let c=document.getElementById("address");function e(o){window.ymaps.geocode(o).then(r=>{let s=r.geoObjects.get(0).getAddressLine();c&&(c.value=s)})}window.myPlacemark.events.add("dragend",()=>{let o=window.myPlacemark.geometry.getCoordinates();e(o)}),window.myMap.events.add("click",o=>{let r=o.get("coords");window.myPlacemark.geometry.setCoordinates(r),e(r)});let t="\u0433. \u0421\u0430\u043D\u043A\u0442-\u041F\u0435\u0442\u0435\u0440\u0431\u0443\u0440\u0433, \u043F\u0440. \u041F\u0440\u043E\u0441\u0432\u0435\u0449\u0435\u043D\u0438\u044F, \u0434. 99, \u043A\u0432. 152";window.ymaps.geocode(t).then(o=>{let r=o.geoObjects.get(0).geometry.getCoordinates();window.myMap.setCenter(r,16),window.myPlacemark.geometry.setCoordinates(r),c&&(c.value=t)})})}function f(){let c="fe79d58476db2b061699143532f7c3b8dc2d1766",e=document.getElementById("address"),t=document.getElementById("search-address"),o=document.getElementById("suggestions");t.addEventListener("click",async()=>{let r=e.value.trim();if(!r)return;let s=await(await fetch("https://suggestions.dadata.ru/suggestions/api/4_1/rs/suggest/address",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Token ${c}`},body:JSON.stringify({query:r})})).json();if(o.innerHTML="",s.suggestions.length===0){let n=document.createElement("li");n.textContent="\u0410\u0434\u0440\u0435\u0441 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D",o.appendChild(n)}else s.suggestions.forEach(n=>{let a=document.createElement("li");a.textContent=n.value,a.addEventListener("click",()=>{e.value=n.value,o.style.display="none";let l=n.data.geo_lat,p=n.data.geo_lon;l&&p&&window.myPlacemark&&window.myMap&&(window.myPlacemark.geometry.setCoordinates([l,p]),window.myMap.setCenter([l,p],16))}),o.appendChild(a)});o.style.display="block"})}var u=[{id:1,title:"\u0423\u0442\u0435\u043F\u043B\u0435\u043D\u043D\u0430\u044F \u0441\u0442\u0435\u0433\u0430\u043D\u043D\u0430\u044F \u043A\u0443\u0440\u0442\u043A\u0430 \u0436\u0435\u043D\u0441\u043A\u0430\u044F Top Hills",price:1e4,oldPrice:12e3,qty:2,size:"M",color:"black"},{id:2,title:"\u0412\u044F\u0437\u0430\u043D\u043D\u0430\u044F \u0448\u0430\u043F\u043A\u0430 Zolla",price:500,qty:1,size:"S",color:"black"},{id:3,title:"\u0423\u0442\u0435\u043F\u043B\u0435\u043D\u043D\u0430\u044F \u0441\u0442\u0435\u0433\u0430\u043D\u043D\u0430\u044F \u043A\u0443\u0440\u0442\u043A\u0430 \u0436\u0435\u043D\u0441\u043A\u0430\u044F Top Hills",price:3e3,oldPrice:4e3,qty:2,size:"L",color:"white"}];function g(c){c.forEach(e=>{let t=document.querySelector(`.cart-list__item[data-id="${e.id}"]`);if(!t)return;t.querySelector(".cart-list__title").textContent=e.title;let o=t.querySelector(".cart-list__price");o&&(o.textContent=e.price.toLocaleString()+" \u20BD");let r=t.querySelector(".cart-list__qty-input");r.value=e.qty;let i=t.querySelector(".cart-list__total");i&&(i.textContent=(e.qty*e.price).toLocaleString()+" \u20BD");let s=t.querySelector(".cart-list__old-price");s&&(e.oldPrice?(s.textContent=e.oldPrice.toLocaleString()+" \u20BD",s.style.display="inline"):s.style.display="none");let n=t.querySelector(".cart-list__old-total");n&&(e.oldPrice?(n.textContent=(e.oldPrice*e.qty).toLocaleString()+" \u20BD",n.style.display="inline"):n.style.display="none");let a=t.querySelector(`input[name="size-${e.id}"][value="${e.size}"]`);a&&(a.checked=!0);let l=t.querySelector(`input[name="color-${e.id}"][value="${e.color}"]`);l&&(l.checked=!0)})}function m(c,e=null){let t=0,o=0;c.forEach(d=>{t+=d.price*d.qty,d.oldPrice?o+=d.oldPrice*d.qty:o+=d.price*d.qty});let r=o-t+e,i=o-t,s=200,n=t+s-e,a=document.querySelector(".cart__aside-price--total");a&&(a.textContent=o.toLocaleString()+" \u20BD");let l=document.querySelector(".cart__aside-price--discount");l&&(l.textContent=r>0?`\u2212 ${r.toLocaleString()} \u20BD`:"0 \u20BD");let p=document.querySelector(".cart__aside-price--delivery");p&&(p.textContent=s.toLocaleString()+" \u20BD");let _=document.querySelector(".cart__summary-price strong");_&&(_.textContent=n.toLocaleString()+" \u20BD");let S=document.querySelector(".cart__aside-price--action");S&&(S.textContent="- "+i.toLocaleString()+" \u20BD")}function w(){let c=document.querySelector(".cart__promo-input"),e=document.querySelector(".cart__promo-button"),t=document.querySelector(".cart__promo-message"),o=document.querySelector(".cart__row--promo");c.addEventListener("input",()=>{c.value.trim()!==""?e.classList.add("visible"):e.classList.remove("visible")});let r={B6D9FC:500},i=null;e.addEventListener("click",s=>{s.preventDefault();let n=c.value.trim().toUpperCase();t.className="cart__promo-message",i=null,r[n]?(i=r[n],m(u,i),t.textContent=`${n} - \u043A\u0443\u043F\u043E\u043D \u043F\u0440\u0438\u043C\u0435\u043D\u0435\u043D`,t.classList.add("cart__promo--success"),o.style.display="flex"):(m(u,i),t.textContent=`${n} - \u043A\u0443\u043F\u043E\u043D \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D`,t.classList.add("cart__promo--error"),o.style.display="none")})}document.addEventListener("DOMContentLoaded",()=>{y(),f(),g(u),m(u),w()});
